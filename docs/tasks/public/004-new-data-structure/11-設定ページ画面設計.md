# BOM設定ページ画面設計

## 概要

BOM v2システムの各種マスタデータ・スキーマを管理する設定ページ。
製造業のユーザーがJSONなどの技術的知識なしで設定できるフォームベースのUIを提供する。

---

## ページ構成

```
/settings/bom                       # BOM設定トップ（リダイレクト）
/settings/bom/facet-types           # 属性定義（詳細・編集はモーダル）
/settings/bom/part-number-rules     # 品番体系
/settings/bom/departments           # 部署管理
/settings/bom/users                 # ユーザー管理
/settings/bom/master-options        # 選択肢マスタ
```

---

## 全体レイアウト

```
┌─────────────────────────────────────────────────────────────────────┐
│  [Logo]  archaive                              [User] 山田太郎 ▼    │
├─────────────┬───────────────────────────────────────────────────────┤
│             │                                                       │
│  BOM設定    │  [コンテンツエリア]                                   │
│             │                                                       │
│  ─────────  │                                                       │
│  データ定義 │                                                       │
│             │                                                       │
│  ┌─────────┐│                                                       │
│  │ 属性定義 ││                                                       │
│  └─────────┘│                                                       │
│  ┌─────────┐│                                                       │
│  │ 品番体系 ││                                                       │
│  └─────────┘│                                                       │
│  ┌─────────┐│                                                       │
│  │選択肢   ││                                                       │
│  └─────────┘│                                                       │
│             │                                                       │
│  ─────────  │                                                       │
│  組織       │                                                       │
│             │                                                       │
│  ┌─────────┐│                                                       │
│  │ 部署管理 ││                                                       │
│  └─────────┘│                                                       │
│  ┌─────────┐│                                                       │
│  │ユーザー ││                                                       │
│  └─────────┘│                                                       │
│             │                                                       │
├─────────────┴───────────────────────────────────────────────────────┤
│  サイドバー幅: 240px | コンテンツ: flex-1                           │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 1. 属性定義（FacetType）

### 1-1. 一覧画面 `/settings/bom/facet-types`

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  属性定義                                           [+ 新規作成]    │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  部品・製品に付与できる属性のスキーマを管理します                   │
│                                                                     │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │ カテゴリで絞り込み: [全て ▼]  検索: [____________] [検索]      │ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │                                                                │ │
│  │  ■ 設計属性 (Design)                                          │ │
│  │  ├─────────────────────────────────────────────────────────── │ │
│  │  │ 基本設計属性        材質・重量・寸法など       6項目       │ │
│  │  │ DESIGN_BASIC        Product, Assembly, Part    [編集] [削除]│ │
│  │  ├─────────────────────────────────────────────────────────── │ │
│  │  │ 電気特性            電圧・電流・消費電力       5項目       │ │
│  │  │ DESIGN_ELECTRICAL   Assembly, Part, Purchased  [編集] [削除]│ │
│  │  │                                                            │ │
│  │  ■ 調達属性 (Procurement)                                     │ │
│  │  ├─────────────────────────────────────────────────────────── │ │
│  │  │ 調達属性            仕入先・価格・リードタイム  9項目      │ │
│  │  │ PROCUREMENT         Part, Purchased, RawMaterial [編集][削除]│ │
│  │  │                                                            │ │
│  │  ■ 製造属性 (Manufacturing)                                   │ │
│  │  ├─────────────────────────────────────────────────────────── │ │
│  │  │ 製造属性            工程・設備・工数           7項目       │ │
│  │  │ MANUFACTURING       Product, Assembly, Part    [編集] [削除]│ │
│  │  │                                                            │ │
│  │  ■ 図面属性 (Drawing)                                         │ │
│  │  ├─────────────────────────────────────────────────────────── │ │
│  │  │ 図面メタデータ      作成者・承認者・規格       9項目       │ │
│  │  │ DRAWING_META        Product, Assembly, Part    [編集] [削除]│ │
│  │  │                                                            │ │
│  │  ■ 帳票属性 (Document)                                        │ │
│  │  ├─────────────────────────────────────────────────────────── │ │
│  │  │ 帳票メタデータ      作成者・有効期限・金額     11項目      │ │
│  │  │ DOCUMENT_META       全ItemType                 [編集] [削除]│ │
│  │                                                                │ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 一覧画面の動作

| 操作 | 動作 |
|------|------|
| [+ 新規作成] | 新規作成モーダルを表示 |
| カテゴリ絞り込み | Design/Procurement/Manufacturing/Drawing/Documentでフィルタ |
| [編集] | 詳細・編集モーダルを表示 |
| [削除] | 削除確認ダイアログ表示 → 削除実行 |

---

### 1-2. 詳細・編集モーダル

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  基本設計属性                                                 [×]  │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  ┌─ 基本情報 ─────────────────────────────────────────────────────┐ │
│  │                                                                │ │
│  │  属性名 *                                                      │ │
│  │  [基本設計属性                                    ]            │ │
│  │                                                                │ │
│  │  コード *（英数字・アンダースコア）                            │ │
│  │  [DESIGN_BASIC                                   ]            │ │
│  │                                                                │ │
│  │  カテゴリ *                                                    │ │
│  │  [設計属性 (Design)                              ▼]            │ │
│  │                                                                │ │
│  │  説明                                                          │ │
│  │  [部品・製品の基本的な設計情報。材質、重量、寸法、表面処理など]│ │
│  │                                                                │ │
│  │  適用可能なアイテムタイプ *                                    │ │
│  │  [✓] 完成品 (Product)                                         │ │
│  │  [✓] アセンブリ (Assembly)                                    │ │
│  │  [✓] 製造部品 (Part)                                          │ │
│  │  [ ] 購入品 (Purchased)                                       │ │
│  │  [ ] 原材料 (RawMaterial)                                     │ │
│  │                                                                │ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  ┌─ 属性項目（プロパティ） ────────────────────────────────────────┐ │
│  │                                                    [+ 項目追加] │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ ≡  材質 *                                        [削除]  │ │ │
│  │  │    material | 選択式 | 必須                              │ │ │
│  │  │    選択肢: アルミニウム合金, ステンレス鋼, 炭素鋼...     │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ ≡  重量                                          [削除]  │ │ │
│  │  │    weight | 数値 | 単位: kg                              │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ ≡  寸法                                          [削除]  │ │ │
│  │  │    dimensions | テキスト                                 │ │ │
│  │  │    説明: W x D x H (mm)                                  │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ ≡  表面処理                                      [削除]  │ │ │
│  │  │    surfaceTreatment | 選択式                             │ │ │
│  │  │    選択肢: なし, アルマイト, ニッケルメッキ...           │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ ≡  公差等級                                      [削除]  │ │ │
│  │  │    toleranceClass | 選択式                               │ │ │
│  │  │    選択肢: IT5, IT6, IT7, IT8...                         │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ ≡  色                                            [削除]  │ │ │
│  │  │    color | テキスト                                      │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  （ドラッグ&ドロップで並び替え可能）                          │ │
│  │                                                                │ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                     │
│                                        [キャンセル]  [保存する]     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

### 1-3. 項目追加ダイアログ

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  属性項目を追加                                              [×]   │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  項目名（表示ラベル） *                                             │
│  [                                                     ]            │
│                                                                     │
│  プロパティ名（英数字） *                                           │
│  [                                                     ]            │
│  ※ システム内部で使用する識別子です                                 │
│                                                                     │
│  データ型 *                                                         │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ (●) テキスト     自由入力のテキスト                         │   │
│  │ ( ) 数値         数値入力（単位指定可）                     │   │
│  │ ( ) 選択式       定義済みの選択肢から選択                   │   │
│  │ ( ) 真偽値       はい/いいえの2択                           │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ─────────────────────────────────────────────────────────────────  │
│  追加オプション                                                     │
│                                                                     │
│  [ ] 必須項目にする                                                 │
│                                                                     │
│  説明（入力時のヒント）                                             │
│  [                                                     ]            │
│                                                                     │
│  ═══════════════════════════════════════════════════════════════   │
│  データ型が「数値」の場合                                           │
│                                                                     │
│  単位                                                               │
│  [        ] 例: kg, mm, 円                                         │
│                                                                     │
│  最小値              最大値                                         │
│  [        ]          [        ]                                    │
│                                                                     │
│  ═══════════════════════════════════════════════════════════════   │
│  データ型が「選択式」の場合                                         │
│                                                                     │
│  選択肢 *                                     [+ 選択肢を追加]      │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ [アルミニウム合金        ] [×]                              │   │
│  │ [ステンレス鋼            ] [×]                              │   │
│  │ [炭素鋼                  ] [×]                              │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  または選択肢マスタから取得:                                        │
│  [選択肢マスタを使用しない                              ▼]         │
│                                                                     │
│                                                                     │
│                                       [キャンセル]  [追加する]      │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 詳細・編集モーダルの動作

| 操作 | 動作 |
|------|------|
| [+ 項目追加] | 項目追加ダイアログを表示（モーダル内でネスト） |
| ≡ ドラッグ | 項目の並び順を変更 |
| 項目クリック | 項目の編集ダイアログを表示 |
| [削除] | 項目を削除（確認なし、保存前なので） |
| [×] / [キャンセル] | 変更を破棄してモーダルを閉じる |
| [保存する] | 変更を保存してモーダルを閉じる |

---

## 2. 品番体系（Part Number Rules）

### 2-1. 一覧画面 `/settings/bom/part-number-rules`

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  品番体系                                             [+ 新規作成]  │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  アイテムタイプごとの品番プレフィックスと採番ルールを管理します     │
│                                                                     │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 完成品 (Product)                                         │ │ │
│  │  │ プレフィックス: PRD-                                     │ │ │
│  │  │ 形式: PRD-{カテゴリ}-{連番4桁}                           │ │ │
│  │  │ 例: PRD-ARM-1000, PRD-AGV-2000                          │ │ │
│  │  │                                              [編集]       │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ アセンブリ (Assembly)                                    │ │ │
│  │  │ プレフィックス: ASY-                                     │ │ │
│  │  │ 形式: ASY-{カテゴリ}-{連番3桁}                           │ │ │
│  │  │ 例: ASY-BASE-100, ASY-DRV-110                           │ │ │
│  │  │                                              [編集]       │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 製造部品 (Part)                                          │ │ │
│  │  │ プレフィックス: PRT-                                     │ │ │
│  │  │ 形式: PRT-{カテゴリ}-{連番3桁}                           │ │ │
│  │  │ 例: PRT-GER-001, PRT-PLT-001                            │ │ │
│  │  │                                              [編集]       │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 購入品 (Purchased)                                       │ │ │
│  │  │ プレフィックス: PUR-                                     │ │ │
│  │  │ 形式: PUR-{カテゴリ}-{連番3桁}                           │ │ │
│  │  │ 例: PUR-MTR-001, PUR-BRG-001                            │ │ │
│  │  │                                              [編集]       │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 原材料 (RawMaterial)                                     │ │ │
│  │  │ プレフィックス: RAW-                                     │ │ │
│  │  │ 形式: RAW-{材質}-{連番3桁}                               │ │ │
│  │  │ 例: RAW-ALM-001, RAW-SUS-001                            │ │ │
│  │  │                                              [編集]       │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 2-2. 編集ダイアログ

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  品番体系を編集: 完成品 (Product)                            [×]   │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  プレフィックス *                                                   │
│  [PRD-                                                 ]            │
│                                                                     │
│  品番形式                                                           │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ [PRD-] + [カテゴリ ▼] + [-] + [連番4桁 ▼]                   │   │
│  │                                                             │   │
│  │ プレビュー: PRD-ARM-0001                                    │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  連番の開始値                                                       │
│  [1                                                    ]            │
│                                                                     │
│  カテゴリ選択肢                                [+ カテゴリ追加]     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ [ARM ] ロボットアーム                            [×]        │   │
│  │ [AGV ] 無人搬送車                                [×]        │   │
│  │ [CNC ] CNC工作機械                               [×]        │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│                                       [キャンセル]  [保存する]      │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 3. 部署管理（Departments）

### 3-1. 一覧画面 `/settings/bom/departments`

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  部署管理                                             [+ 新規作成]  │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  組織の部署を管理します。タスクの担当者割り当てなどに使用します。   │
│                                                                     │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │ 部署名           │ 所属人数  │ 説明               │ 操作      │ │
│  ├────────────────────────────────────────────────────────────────┤ │
│  │ 設計部           │ 3名       │ 製品設計・CAD      │[編集][削除]│ │
│  │ 品質管理部       │ 2名       │ 品質検査・試験     │[編集][削除]│ │
│  │ 購買部           │ 2名       │ 調達・仕入先管理   │[編集][削除]│ │
│  │ 製造部           │ 5名       │ 組立・加工         │[編集][削除]│ │
│  │ 生産技術部       │ 3名       │ 工程設計・治具     │[編集][削除]│ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  ※ 所属人数が1名以上の部署は削除できません                          │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 3-2. 編集ダイアログ

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  部署を編集                                                  [×]   │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  部署名 *                                                           │
│  [設計部                                               ]            │
│                                                                     │
│  説明                                                               │
│  [製品設計・CAD作成を担当                              ]            │
│                                                                     │
│                                       [キャンセル]  [保存する]      │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 4. ユーザー管理（Users）

### 4-1. 一覧画面 `/settings/bom/users`

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  ユーザー管理                                         [+ 新規作成]  │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  システムを利用するユーザーを管理します                             │
│                                                                     │
│  検索: [____________]  部署: [全て        ▼]  [検索]                │
│                                                                     │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │       │ 名前       │ メール              │ 部署     │ 操作    │ │
│  ├────────────────────────────────────────────────────────────────┤ │
│  │  🧑   │ 山田太郎   │ yamada@example.com  │ 設計部   │[編集]   │ │
│  │  👩   │ 佐藤花子   │ sato@example.com    │ 品質管理部│[編集]   │ │
│  │  🧑   │ 田中一郎   │ tanaka@example.com  │ 購買部   │[編集]   │ │
│  │  🧑   │ 鈴木健二   │ suzuki@example.com  │ 製造部   │[編集]   │ │
│  │  👩   │ 高橋美咲   │ takahashi@example.com│ 生産技術部│[編集]   │ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  1-5 / 5件                                          [<] [1] [>]     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 4-2. 編集ダイアログ

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  ユーザーを編集                                              [×]   │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│        ┌──────┐                                                     │
│        │  🧑  │  [アバター変更]                                    │
│        └──────┘                                                     │
│                                                                     │
│  名前 *                                                             │
│  [山田太郎                                             ]            │
│                                                                     │
│  メールアドレス *                                                   │
│  [yamada@example.com                                   ]            │
│                                                                     │
│  部署 *                                                             │
│  [設計部                                               ▼]           │
│                                                                     │
│  役割                                                               │
│  [ ] 管理者（設定変更可能）                                         │
│  [✓] 一般ユーザー                                                  │
│                                                                     │
│                      [削除する]     [キャンセル]  [保存する]        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 5. 選択肢マスタ（Master Options）

### 5-1. 一覧画面 `/settings/bom/master-options`

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  選択肢マスタ                                         [+ 新規作成]  │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  属性入力時の選択肢を一元管理します。                               │
│  属性定義で「選択肢マスタを使用」すると、ここで定義した選択肢が     │
│  自動的に使用されます。                                             │
│                                                                     │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 材質                                           [編集]    │ │ │
│  │  │ MATERIAL | 10件の選択肢                                  │ │ │
│  │  │ アルミニウム合金, ステンレス鋼, 炭素鋼, 鋳鉄, 銅合金...  │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 表面処理                                       [編集]    │ │ │
│  │  │ SURFACE_TREATMENT | 10件の選択肢                         │ │ │
│  │  │ なし, アルマイト, 硬質アルマイト, ニッケルメッキ...      │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 公差等級                                       [編集]    │ │ │
│  │  │ TOLERANCE_CLASS | 8件の選択肢                            │ │ │
│  │  │ IT5, IT6, IT7, IT8, IT9, IT10, IT11, IT12                │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 保護等級（IP）                                 [編集]    │ │ │
│  │  │ IP_CLASS | 7件の選択肢                                   │ │ │
│  │  │ IP20, IP40, IP54, IP55, IP65, IP67, IP68                 │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 通貨                                           [編集]    │ │ │
│  │  │ CURRENCY | 4件の選択肢                                   │ │ │
│  │  │ JPY, USD, EUR, CNY                                       │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 製造工程                                       [編集]    │ │ │
│  │  │ PROCESS | 10件の選択肢                                   │ │ │
│  │  │ 機械加工, 溶接, 板金加工, 表面処理, 組立, 検査...        │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 製造拠点                                       [編集]    │ │ │
│  │  │ MANUFACTURING_LOCATION | 5件の選択肢                     │ │ │
│  │  │ 本社工場, 第二工場, 協力工場A, 協力工場B, 海外工場       │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  │  ┌──────────────────────────────────────────────────────────┐ │ │
│  │  │ 調達区分                                       [編集]    │ │ │
│  │  │ PROCUREMENT_TYPE | 3件の選択肢                           │ │ │
│  │  │ 内製, 外注, 購入                                         │ │ │
│  │  └──────────────────────────────────────────────────────────┘ │ │
│  │                                                                │ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 5-2. 編集ダイアログ

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  選択肢マスタを編集: 材質                                    [×]   │
│  ─────────────────────────────────────────────────────────────────  │
│                                                                     │
│  マスタ名 *                                                         │
│  [材質                                                 ]            │
│                                                                     │
│  コード *（英数字・アンダースコア）                                 │
│  [MATERIAL                                             ]            │
│                                                                     │
│  選択肢                                        [+ 選択肢を追加]     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ ≡ [アルミニウム合金                         ] [×]          │   │
│  │ ≡ [ステンレス鋼                             ] [×]          │   │
│  │ ≡ [炭素鋼                                   ] [×]          │   │
│  │ ≡ [鋳鉄                                     ] [×]          │   │
│  │ ≡ [銅合金                                   ] [×]          │   │
│  │ ≡ [樹脂                                     ] [×]          │   │
│  │ ≡ [CFRP                                     ] [×]          │   │
│  │ ≡ [セラミック                               ] [×]          │   │
│  │ ≡ [複合材                                   ] [×]          │   │
│  │ ≡ [その他                                   ] [×]          │   │
│  └─────────────────────────────────────────────────────────────┘   │
│  （ドラッグ&ドロップで並び替え可能）                                │
│                                                                     │
│  使用箇所: 基本設計属性 (DESIGN_BASIC)                              │
│                                                                     │
│                      [削除する]     [キャンセル]  [保存する]        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 動作一覧まとめ

### 共通動作

| 操作 | 動作 |
|------|------|
| サイドバー項目クリック | 対応する一覧ページへ遷移 |
| [+ 新規作成] | 新規作成ダイアログ or 新規作成ページへ遷移 |
| [編集] | 編集ダイアログ or 編集ページへ遷移 |
| [削除] | 削除確認ダイアログ → 削除実行 |
| [保存する] | バリデーション → API呼び出し → 成功時は一覧へ戻る |
| [キャンセル] | 変更を破棄して一覧へ戻る/ダイアログを閉じる |

### 属性定義（FacetType）固有

| 操作 | 動作 |
|------|------|
| [+ 項目追加] | 項目追加ダイアログを表示 |
| ≡ ドラッグ | 項目の並び順を変更 |
| データ型変更 | 追加オプションの表示を切り替え |
| 選択肢マスタを選択 | マスタの選択肢を自動取得 |

### 削除時の制約

| エンティティ | 削除条件 |
|-------------|----------|
| FacetType | 使用中のFacetInstanceがない場合のみ |
| 部署 | 所属ユーザーがいない場合のみ |
| ユーザー | タスクの担当者になっていない場合のみ |
| 選択肢マスタ | FacetTypeで参照されていない場合のみ |

---

## 技術的な補足

### URL設計

```
/settings/bom                       → /settings/bom/facet-types へリダイレクト
/settings/bom/facet-types           → 一覧（モーダルで新規作成・編集）
/settings/bom/part-number-rules     → 一覧（モーダルで編集）
/settings/bom/departments           → 一覧（モーダルで編集）
/settings/bom/users                 → 一覧（モーダルで編集）
/settings/bom/master-options        → 一覧（モーダルで編集）
```

### FSD配置

```
page-components/
└── settings/
    └── bom/
        ├── facet-types/
        │   └── ui/
        │       └── FacetTypesContainer.tsx
        ├── part-number-rules/
        │   └── ui/
        │       └── PartNumberRulesContainer.tsx
        ├── departments/
        │   └── ui/
        │       └── DepartmentsContainer.tsx
        ├── users/
        │   └── ui/
        │       └── UsersContainer.tsx
        └── master-options/
            └── ui/
                └── MasterOptionsContainer.tsx

features/
└── settings/
    └── bom/
        └── facet-type-editor/
            └── ui/
                ├── FacetTypeEditorModal.tsx        # メインモーダル
                ├── BasicInfoForm.tsx               # 基本情報フォーム
                ├── PropertyList.tsx                # 属性項目リスト
                └── PropertyAddDialog.tsx           # 項目追加ダイアログ

widgets/
└── settings/
    └── bom-sidebar/
        └── ui/
            └── BomSettingsSidebarWidget.tsx
```

---

**作成日**: 2025-01-09
